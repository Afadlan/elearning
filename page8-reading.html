<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>ReallyEnglish Placement Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    rel="stylesheet"
  />
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: "Roboto", sans-serif;
      perspective: 1000px;
      background-color: #f0f7ff;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    /* 3D Card container */
    .card {
      transition: transform 0.2s ease, box-shadow 0.3s ease;
      will-change: transform;
      transform-style: preserve-3d;
      border-radius: 1rem;
      cursor: grab;
      background: white;
      box-shadow: 0 8px 15px rgba(59, 130, 246, 0.1);
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      padding: 1.5rem;
    }
    .card:active {
      cursor: grabbing;
    }
    .card:hover {
      box-shadow: 0 20px 40px rgba(59, 130, 246, 0.3);
    }
    /* Button 3D style */
    .btn-animate {
      position: relative;
      overflow: hidden;
      transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
      z-index: 10;
      border-radius: 0.375rem;
      box-shadow: 0 6px 0 #1e40af;
      transform-style: preserve-3d;
      transform-origin: center bottom;
      background-color: #3b82f6;
      color: white;
      font-weight: 600;
      padding: 0.75rem 1.25rem;
      font-size: 0.875rem;
      user-select: none;
      cursor: pointer;
    }
    .btn-animate::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 300%;
      height: 300%;
      background: rgba(59, 130, 246, 0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%) scale(0);
      transition: transform 0.5s ease;
      z-index: 0;
    }
    .btn-animate:hover::before {
      transform: translate(-50%, -50%) scale(1);
    }
    .btn-animate:hover {
      background-color: #2563eb; /* darker blue */
      box-shadow: 0 12px 0 #1e40af;
      transform: translateY(-4px) rotateX(10deg);
      color: white;
      z-index: 11;
    }
    .btn-animate:active {
      box-shadow: 0 3px 0 #1e40af;
      transform: translateY(-1px) rotateX(5deg);
    }
    /* Logo behind text container */
    header {
      position: relative;
      z-index: 10;
      padding: 1.5rem 1.5rem 1.5rem 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      max-width: 90rem;
      margin: 0 auto;
    }
    header .bg-logo {
      position: absolute;
      top: 0;
      right: 0;
      width: 200px;
      height: 200px;
      object-fit: contain;
      border-radius: 9999px;
      opacity: 0.15;
      z-index: 0;
      pointer-events: none;
    }
    @media (max-width: 768px) {
      header .bg-logo {
        width: 120px;
        height: 120px;
        opacity: 0.1;
      }
    }
    @media (max-width: 480px) {
      header .bg-logo {
        width: 80px;
        height: 80px;
        opacity: 0.08;
      }
    }
    .font-golden {
      font-weight: 700;
      color: #2563eb;
      font-size: 1.125rem;
      user-select: none;
    }
    /* Scrollbar hidden for main content */
    main::-webkit-scrollbar {
      display: none;
    }
    main {
      -ms-overflow-style: none;
      scrollbar-width: none;
      position: relative;
      padding-bottom: 5rem; /* space for fixed button */
    }
    /* Form radio spacing */
    form label {
      display: block;
      margin-left: 1.25rem;
      margin-bottom: 0.25rem;
      font-size: 0.75rem;
      color: #1e293b;
      cursor: pointer;
    }
    form p {
      font-size: 0.75rem;
      margin-bottom: 0.5rem;
      color: #334155;
    }
    /* Inner card for conversation text */
    .inner-card {
      border: 1px solid #334155;
      border-radius: 0.5rem;
      padding: 1rem;
      font-size: 0.75rem;
      color: #1e293b;
      line-height: 1.3;
      margin-bottom: 1.5rem;
      background: white;
      user-select: text;
    }
    .inner-card p {
      margin-bottom: 0.5rem;
    }
    .inner-card p strong {
      font-weight: 700;
    }
    .inner-card p u {
      text-decoration-thickness: 2px;
      text-underline-offset: 3px;
    }
    /* Progress bar styling */
    progress {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 0.25rem;
      border-radius: 9999px;
      overflow: hidden;
      margin-top: 0.25rem;
      margin-bottom: 0.5rem;
    }
    progress::-webkit-progress-bar {
      background-color: #cbd5e1;
    }
    progress::-webkit-progress-value {
      background-color: #2563eb;
      transition: width 1s linear;
    }
    progress::-moz-progress-bar {
      background-color: #2563eb;
      transition: width 1s linear;
    }
    /* Fixed next button bottom right */
    .next-button-container {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 20;
    }
    @media (max-width: 640px) {
      .next-button-container {
        position: static;
        margin-top: 1rem;
        display: flex;
        justify-content: flex-end;
        padding-right: 1.5rem;
      }
      main {
        padding-bottom: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <img
      alt="ReallyEnglish logo with letters R and E in blue square"
      class="relative z-10"
      height="40"
      src="https://storage.googleapis.com/a1aa/image/d09cce8d-911a-405c-e6b3-63ef1c89ae3a.jpg"
      width="40"
      decoding="async"
      loading="lazy"
    />
    <span class="font-golden select-none">ReallyEnglish</span>
    <img
      alt="Large blue gradient circle shape behind header text"
      class="bg-logo"
      height="200"
      src="https://storage.googleapis.com/a1aa/image/7a536139-0f90-464f-5576-28fa91748278.jpg"
      width="200"
      decoding="async"
      loading="lazy"
    />
  </header>
  <main class="max-w-4xl mx-auto px-6 py-8 flex-grow">
    <section class="mb-6">
      <div
        class="bg-[#2563eb] text-white text-[10px] text-center py-1 rounded-md select-none font-semibold"
        aria-label="Placement test title"
      >
        Placement - Placement Test Adults
      </div>
      <progress
        id="progressBar"
        max="5400"
        value="3000"
        aria-label="Placement test progress bar"
        role="progressbar"
        aria-valuemin="0"
        aria-valuemax="5400"
        aria-valuenow="3000"
      ></progress>
      <p
        class="text-[10px] text-center text-black/80 select-none leading-tight"
        aria-live="polite"
        aria-atomic="true"
        id="countdownText"
      >
        Durasi 90 menit<br />
        <span id="timeDisplay" style="">0Jam 50Menit 0Detik</span>
      </p>
    </section>
    <section
      class="card rounded-xl"
      aria-label="Reading Comprehension - International Diplomatic Call section"
      id="mainCard"
    >
      <div class="inner-card" aria-live="polite" aria-atomic="true">
        <p class="font-bold text-center mb-1">
          Reading Comprehension - International Diplomatic Call (B2)
        </p>
        <p class="text-center mb-3">
          Read the international diplomatic phone conversation below and answer questions 21-25.
        </p>
        <p class="font-bold mb-3">High-Level Diplomatic Negotiation Call - Trade Agreement</p>
        <p><strong>Ambassador Williams:</strong> Good afternoon, Ambassador Chen. Thank you for making time for this crucial discussion regarding the bilateral trade agreement. I trust you've had an opportunity to review the revised proposals our economic team submitted last week?</p>
        <p><strong>Ambassador Chen:</strong> Indeed, Ambassador Williams. Our trade ministry has conducted a thorough analysis of your proposals. While we appreciate the concessions made regarding agricultural imports, we remain concerned about the intellectual property provisions, particularly those affecting our technology sector.</p>
        <p><strong>Ambassador Williams:</strong> I understand your concerns, and I believe there's room for compromise. Our legal team has indicated flexibility on the patent protection timeline, potentially reducing it from 20 to 15 years for certain categories of technology. Would this address your primary concerns?</p>
        <p><strong>Ambassador Chen:</strong> That would certainly be a step in the right direction. However, we would also need assurances regarding technology transfer requirements. Our companies are particularly sensitive about forced technology sharing as a condition for market access.</p>
        <p><strong>Ambassador Williams:</strong> I can assure you that our revised framework explicitly prohibits mandatory technology transfer. This has been a key point of contention in previous negotiations, and we've made significant adjustments to address these concerns. The new language ensures that technology sharing remains voluntary and commercially driven.</p>
        <p><strong>Ambassador Chen:</strong> That's encouraging news. Now, regarding the dispute resolution mechanism, our legal experts have suggested establishing a joint arbitration panel rather than relying solely on existing international courts. This would provide both parties with more direct control over the process.</p>
        <p><strong>Ambassador Williams:</strong> An interesting proposal. Could you elaborate on the composition and selection process for such a panel? We would need to ensure impartiality and expertise in international trade law.</p>
        <p><strong>Ambassador Chen:</strong> Certainly. We envision a five-member panel: two representatives from each country and a neutral chairperson selected by mutual agreement. All members would be required to have extensive experience in international commercial law and trade disputes.</p>
        <p><strong>Ambassador Williams:</strong> That structure seems reasonable. I'll need to consult with our legal team, but I don't anticipate significant objections. Shall we schedule a follow-up call for next week to discuss the technical details and timeline for implementation?</p>
        <p><strong>Ambassador Chen:</strong> Absolutely. I'm optimistic that we're making substantial progress. Let's aim for Tuesday afternoon, your time. I'll have our trade negotiators prepare detailed proposals for the arbitration framework.</p>
        <p><strong>Ambassador Williams:</strong> Perfect. I'll coordinate with our team and send you a formal agenda by Friday. Thank you for your constructive approach to these negotiations, Ambassador Chen.</p>
        <p><strong>Ambassador Chen:</strong> The pleasure is mutual, Ambassador Williams. I look forward to our continued collaboration in reaching a mutually beneficial agreement.</p>
      </div>
    </section>
    <section
      class="card rounded-xl mt-6"
      aria-label="Question 21"
      role="region"
      aria-labelledby="q21-label"
    >
      <p id="q21-label" class="mb-2 text-[10px] font-semibold">
        21. What is Ambassador Chen's main concern about the trade agreement?
      </p>
      <form>
        <label>
          <input class="mr-1" name="q21" type="radio" value="Agricultural import restrictions" /> Agricultural import restrictions
        </label>
        <label>
          <input class="mr-1" name="q21" type="radio" value="Intellectual property provisions" /> Intellectual property provisions
        </label>
        <label>
          <input class="mr-1" name="q21" type="radio" value="Currency exchange rates" /> Currency exchange rates
        </label>
        <label>
          <input class="mr-1" name="q21" type="radio" value="Labor market access" /> Labor market access
        </label>
      </form>
    </section>
    <section
      class="card rounded-xl mt-6"
      aria-label="Question 22"
      role="region"
      aria-labelledby="q22-label"
    >
      <p id="q22-label" class="mb-2 text-[10px] font-semibold">
        22. What compromise does Ambassador Williams offer regarding patent protection?
      </p>
      <form>
        <label>
          <input class="mr-1" name="q22" type="radio" value="Reducing timeline from 25 to 20 years" /> Reducing timeline from 25 to 20 years
        </label>
        <label>
          <input class="mr-1" name="q22" type="radio" value="Reducing timeline from 20 to 15 years" /> Reducing timeline from 20 to 15 years
        </label>
        <label>
          <input class="mr-1" name="q22" type="radio" value="Eliminating patent protection entirely" /> Eliminating patent protection entirely
        </label>
        <label>
          <input class="mr-1" name="q22" type="radio" value="Extending timeline from 15 to 20 years" /> Extending timeline from 15 to 20 years
        </label>
      </form>
    </section>
    <section
      class="card rounded-xl mt-6"
      aria-label="Question 23"
      role="region"
      aria-labelledby="q23-label"
    >
      <p id="q23-label" class="mb-2 text-[10px] font-semibold">
        23. What does Ambassador Williams assure regarding technology transfer?
      </p>
      <form>
        <label>
          <input class="mr-1" name="q23" type="radio" value="It will be mandatory for all companies" /> It will be mandatory for all companies
        </label>
        <label>
          <input class="mr-1" name="q23" type="radio" value="It will be prohibited entirely" /> It will be prohibited entirely
        </label>
        <label>
          <input class="mr-1" name="q23" type="radio" value="It will remain voluntary and commercially driven" /> It will remain voluntary and commercially driven
        </label>
        <label>
          <input class="mr-1" name="q23" type="radio" value="It will be regulated by international courts" /> It will be regulated by international courts
        </label>
      </form>
    </section>
    <section
      class="card rounded-xl mt-6"
      aria-label="Question 24"
      role="region"
      aria-labelledby="q24-label"
    >
      <p id="q24-label" class="mb-2 text-[10px] font-semibold">
        24. How many members would the proposed joint arbitration panel have?
      </p>
      <form>
        <label>
          <input class="mr-1" name="q24" type="radio" value="Three members" /> Three members
        </label>
        <label>
          <input class="mr-1" name="q24" type="radio" value="Five members" /> Five members
        </label>
        <label>
          <input class="mr-1" name="q24" type="radio" value="Seven members" /> Seven members
        </label>
        <label>
          <input class="mr-1" name="q24" type="radio" value="Nine members" /> Nine members
        </label>
      </form>
    </section>
    <section
      class="card rounded-xl mt-6"
      aria-label="Question 25"
      role="region"
      aria-labelledby="q25-label"
    >
      <p id="q25-label" class="mb-2 text-[10px] font-semibold">
        25. When is the follow-up call scheduled?
      </p>
      <form>
        <label>
          <input class="mr-1" name="q25" type="radio" value="Friday afternoon" /> Friday afternoon
        </label>
        <label>
          <input class="mr-1" name="q25" type="radio" value="Monday morning" /> Monday morning
        </label>
        <label>
          <input class="mr-1" name="q25" type="radio" value="Tuesday afternoon" /> Tuesday afternoon
        </label>
        <label>
          <input class="mr-1" name="q25" type="radio" value="Wednesday evening" /> Wednesday evening
        </label>
      </form>
    </section>
  </main>
  <div class="next-button-container">
    <a href="page9.html" class="btn-animate inline-block text-center" aria-label="Continue to Reading Section">
      Continue to Reading
    </a>
  </div>
  <script>
    // 3D card tilt effect
    const cards = document.querySelectorAll(".card");
    cards.forEach((card) => {
      card.addEventListener("mousemove", (e) => {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left; // x position within the element.
        const y = e.clientY - rect.top; // y position within the element.
        const centerX = rect.width / 2;
        const centerY = rect.height / 2;
        const rotateX = ((y - centerY) / centerY) * 10; // max 10deg rotation
        const rotateY = ((x - centerX) / centerX) * 10;
        card.style.transform = `rotateX(${-rotateX}deg) rotateY(${rotateY}deg) scale(1.05)`;
      });
      card.addEventListener("mouseleave", () => {
        card.style.transform = "rotateX(0deg) rotateY(0deg) scale(1)";
      });
    });

    // Countdown timer for 90 minutes (5400 seconds) with localStorage persistence
    const totalSeconds = 90 * 60;
    const progressBar = document.getElementById("progressBar");
    const timeDisplay = document.getElementById("timeDisplay");
    
    // Initialize timer - check if timer already exists in localStorage
    let remainingSeconds;
    const savedTime = localStorage.getItem('testRemainingTime');
    const savedTimestamp = localStorage.getItem('testTimestamp');
    
    if (savedTime && savedTimestamp) {
      // Calculate elapsed time since last save
      const currentTime = Date.now();
      const elapsedSeconds = Math.floor((currentTime - parseInt(savedTimestamp)) / 1000);
      remainingSeconds = Math.max(0, parseInt(savedTime) - elapsedSeconds);
    } else {
      // First time - start with full time
      remainingSeconds = totalSeconds;
      localStorage.setItem('testRemainingTime', remainingSeconds.toString());
      localStorage.setItem('testTimestamp', Date.now().toString());
    }

    function updateCountdown() {
      if (remainingSeconds < 0) {
        remainingSeconds = 0;
        clearInterval(timerInterval);
        localStorage.removeItem('testRemainingTime');
        localStorage.removeItem('testTimestamp');
      }
      
      // Update progress bar value and aria-valuenow
      progressBar.value = remainingSeconds;
      progressBar.setAttribute("aria-valuenow", remainingSeconds);

      // Update countdown text specifically for #timeDisplay
      const hours = Math.floor(remainingSeconds / 3600);
      const minutes = Math.floor((remainingSeconds % 3600) / 60);
      const seconds = remainingSeconds % 60;
      const displayText = `${hours}Jam ${minutes}Menit ${seconds}Detik`;
      timeDisplay.textContent = displayText;
      
      // Save current state to localStorage
      localStorage.setItem('testRemainingTime', remainingSeconds.toString());
      localStorage.setItem('testTimestamp', Date.now().toString());
      
      remainingSeconds--;
    }

    updateCountdown();
    const timerInterval = setInterval(updateCountdown, 1000);

    // Tab visibility detection and modal notification
    let isTabSwitchModalShown = false;
    
    // Create modal HTML
    const modalHTML = `
      <div id="tabSwitchModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); z-index: 9999; justify-content: center; align-items: center;">
        <div style="background: white; padding: 2rem; border-radius: 1rem; max-width: 400px; text-align: center; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);">
          <div style="color: #dc2626; font-size: 3rem; margin-bottom: 1rem;">⚠️</div>
          <h2 style="color: #1e293b; margin-bottom: 1rem; font-size: 1.25rem; font-weight: 700;">Peringatan!</h2>
          <p style="color: #64748b; margin-bottom: 1.5rem; line-height: 1.5;">Anda terdeteksi membuka tab lain. Harap fokus pada halaman tes untuk melanjutkan.</p>
          <button id="closeTabModal" style="background-color: #3b82f6; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: background-color 0.3s;">
            Kembali ke Tes
          </button>
        </div>
      </div>
    `;
    
    // Add modal to page
    document.body.insertAdjacentHTML('beforeend', modalHTML);
    
    const modal = document.getElementById('tabSwitchModal');
    const closeBtn = document.getElementById('closeTabModal');
    
    // Close modal function
    closeBtn.addEventListener('click', () => {
      modal.style.display = 'none';
      isTabSwitchModalShown = false;
    });
    
    // Detect tab visibility change
    document.addEventListener('visibilitychange', () => {
      if (document.hidden && !isTabSwitchModalShown) {
        // User switched to another tab
        setTimeout(() => {
          if (document.hidden && !isTabSwitchModalShown) {
            modal.style.display = 'flex';
            isTabSwitchModalShown = true;
          }
        }, 1000); // Show modal after 1 second of being hidden
      }
    });
    
    // Also detect window blur (when user clicks outside browser)
    window.addEventListener('blur', () => {
      if (!isTabSwitchModalShown) {
        setTimeout(() => {
          if (!document.hasFocus() && !isTabSwitchModalShown) {
            modal.style.display = 'flex';
            isTabSwitchModalShown = true;
          }
        }, 1000);
      }
    });
  </script>
</body>
</html>
